/* 中文UI字体定义 */
@font-face {
  font-family: 'Source Han Sans CN';
  src: url('./fonts/SourceHanSansCN-Regular.otf') format('opentype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* 终端字体定义 */
@font-face {
  font-family: 'MesloLGS NF';
  src: url('./fonts/MesloLGS NF Regular.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* 字体栈定义 */
:root {
  /* UI界面使用中文字体栈 */
  --ui-font-family: 'Source Han Sans CN', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  
  /* 终端使用等宽字体栈 */
  --terminal-font-family: 'MesloLGS NF', 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'Liberation Mono', 'DejaVu Sans Mono', 'Courier New', monospace;
}

/* 字体加载状态处理 - UI字体 */
html:not(.font-loaded) .ui-font {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

html.font-loaded .ui-font {
  font-family: var(--ui-font-family);
}

/* 字体加载状态处理 - 终端字体 */
html:not(.font-loaded) .terminal-font {
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'Liberation Mono', 'DejaVu Sans Mono', 'Courier New', monospace;
}

html.font-loaded .terminal-font {
  font-family: var(--terminal-font-family);
}

html.font-fallback .terminal-font {
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'Liberation Mono', 'DejaVu Sans Mono', 'Courier New', monospace;
}

html.font-fallback .ui-font {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

/* 全局UI字体类 */
.ui-font {
  font-family: var(--ui-font-family);
}

/* 全局终端字体类 */
.terminal-font {
  font-family: var(--terminal-font-family);
}

/* 确保字体渲染质量 */
.ui-font {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.terminal-font {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-variant-ligatures: none; /* 禁用连字，确保字符对齐 */
  font-feature-settings: "liga" 0; /* 禁用连字 */
}

/* Element Plus 组件使用UI字体 */
.el-button, .el-input, .el-text, .el-tag, .el-menu, .el-tooltip, .el-message {
  font-family: var(--ui-font-family) !important;
}

/* 为不同的终端组件提供字体样式 */
.xterm .xterm-viewport,
.xterm .xterm-screen {
  font-family: var(--terminal-font-family) !important;
}

/* 任务列表中的命令文本使用终端字体 */
.task-command-text {
  font-family: var(--terminal-font-family);
}

/* 代码相关的文本使用终端字体 */
.command-text {
  font-family: var(--terminal-font-family);
}

/* 字体加载动画 */
@keyframes fontFadeIn {
  from { 
    opacity: 0.7; 
  }
  to { 
    opacity: 1; 
  }
}

html.font-loaded .ui-font,
html.font-loaded .terminal-font {
  animation: fontFadeIn 0.3s ease-in-out;
}